#!/bin/bash

#killall -q devmon
#killall -q gpg-agent
#killall -q ssh-agent
#killall -q gnome-keyring-daemon
#killall -q gnome-settings-daemon
#killall -q xbindkeys
#killall -q nm-applet

# Devmon udev mounter (part of udevil)
[ $(which devmon) ] \
    && devmon &

xmodmap -e "remove Lock = Caps_Lock"
xmodmap -e "keysym Caps_Lock = Control_L"
xmodmap -e "add Control = Control_L"

# Initialize gnome settings daemon
if [ $(which gnome-settings-daemon) ]; then
  gnome-settings-daemon 2>/dev/null &
  sleep 0.5
  if [ $(which gconftool-2) ]; then
    gconftool-2 -t bool -s /apps/nautilus/preferences/show_desktop false
    gconftool-2 -t bool -s /desktop/gnome/volume_manager/automount_drives true
    gconftool-2 -t bool -s /apps/gnome_settings_daemon/screensaver/start_screensaver false
    gconftool-2 -t bool -s /apps/gnome-keyring/daemon-components/ssh true
    gconftool-2 -t bool -s /desktop/gnome/background/draw_background false
    gconftool-2 -t bool -s /apps/gnome_settings_daemon/plugins/background/active false
    gconftool-2 -t bool -s /apps/gnome_settings_daemon/plugins/ubuntuone/active false
    gconftool-2 -t bool -s /apps/gnome_settings_daemon/plugins/xrandr/active false
  fi
  if [ $(which dconf) ]; then
    dconf write /org/gnome/settings-daemon/plugins/media-keys/active true
  fi
fi

[ $(which gnome-keyring-daemon) ] \
    && export `gnome-keyring-daemon --start`

# Launch the network manager applet
[ $(which nm-applet) ] \
    && nm-applet --sm-disable &

[ $(which gnome-sound-applet) ] \
    && gnome-sound-applet &

[ $(which parcellite) ] \
   && parcellite -d &

#[ -e "${HOME}/.xstart-private" ] \
#    && . "${HOME}/.xstart-private"

feh --bg-scale /usr/share/backgrounds/Forever_by_Shady_S.jpg
trayer --edge top --align right --SetDockType true --SetPartialStrut false --expand true --transparent true --width 10 --tint 0x002b36 --height 20 --monitor 1 &

dbus-launch --exit-with-session /usr/bin/xmonad
